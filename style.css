/* --- Definición de Temas (Variables CSS) --- */
:root {
    --bg-color: #f0f2f5; --container-bg: #ffffff; --text-color: #333; --header-color: #1a2c4e;
    --label-color: #555; --border-color: #ccc; --fieldset-border: #e0e0e0; --status-bg: #f8f9fa;
    --primary-color: #007bff; --primary-hover: #0056b3; --secondary-color: #6c757d;
    --secondary-hover: #5a6268; --danger-color: #dc3545; --danger-hover: #c82333;
    --success-color: #28a745; --warning-color: #ffc107; --warning-hover: #e0a800; --info-color: #17a2b8;
    --disabled-opacity: 0.7; --shadow-color: rgba(0, 0, 0, 0.1);
}
body.dark-mode {
    --bg-color: #121212; --container-bg: #1e1e1e; --text-color: #e0e0e0; --header-color: #bb86fc;
    --label-color: #b0b0b0; --border-color: #444; --fieldset-border: #333; --status-bg: #2a2a2a;
    --primary-color: #bb86fc; --primary-hover: #a05ff9; --secondary-color: #373737;
    --secondary-hover: #4d4d4d; --danger-color: #cf6679; --danger-hover: #e08b98;
    --warning-color: #FFCA28; --warning-hover: #FFD54F; --shadow-color: rgba(255, 255, 255, 0.1);
}
body {font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color:var(--bg-color); color:var(--text-color); display:flex; justify-content:center; align-items:flex-start; min-height:100vh; margin:0; padding:20px 0; transition:background-color .3s, color .3s;}
.container {background-color:var(--container-bg); padding:30px; border-radius:12px; box-shadow:0 4px 20px var(--shadow-color); width:90%; max-width:600px; transition:background-color .3s;}
.main-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
h1 {color:var(--header-color); margin:0;}
fieldset {border:1px solid var(--fieldset-border); border-radius:8px; padding:20px; margin-bottom:20px;}
legend {padding:0 10px; font-weight:600; color:var(--label-color);}
.tabs {overflow:hidden; border-bottom:2px solid var(--fieldset-border); margin-bottom:20px;}
.tab-link {background-color:inherit; float:left; border:none; outline:none; cursor:pointer; padding:14px 16px; transition:.3s; font-size:16px; font-weight:600; color:var(--label-color);}
.tab-link:hover {background-color:var(--status-bg);}
.tab-link.active {color:var(--primary-color); border-bottom:2px solid var(--primary-color);}
.tab-content {display:none; padding:6px 0;}
.form-group {margin-bottom:15px;}
.form-group label {display:block; margin-bottom:8px; font-weight:500; color:var(--label-color);}
input[type=text],input[type=number],textarea,select {width:100%; padding:12px; border:1px solid var(--border-color); background-color:var(--bg-color); color:var(--text-color); border-radius:5px; box-sizing:border-box; font-size:16px; transition:border-color .3s, background-color .3s;}
textarea {resize:vertical;}
textarea::placeholder, input::placeholder {color:var(--label-color); opacity:0.5; font-style:italic;}
small {color:var(--label-color); display:block; margin-top:5px;}
.controls-grid {display:grid; grid-template-columns:1fr 1fr; gap:20px; align-items:start;}
.controls-grid label {font-weight:600 !important;}
.attack-mode-options {display:flex; justify-content:center; gap:20px; margin:10px 0;}
.attack-mode-options label {display:flex; align-items:center; gap:8px; cursor:pointer; font-weight:500;}
button {color:#fff; border:none; padding:12px 20px; border-radius:5px; cursor:pointer; font-size:16px; font-weight:600; transition:background-color .2s, opacity .2s;}
.btn-primary {background-color:var(--primary-color);} .btn-primary:hover {background-color:var(--primary-hover);}
.btn-secondary {background-color:var(--secondary-color);} .btn-secondary:hover {background-color:var(--secondary-hover);}
.btn-danger {background-color:var(--danger-color);} .btn-danger:hover {background-color:var(--danger-hover);}
.btn-warning {background-color:var(--warning-color); color:#212529;} .btn-warning:hover {background-color:var(--warning-hover);}
.action-buttons {display:flex; flex-direction:column; gap:10px; margin-top:15px;}
button:disabled {cursor:not-allowed; background-color:var(--secondary-color); opacity:var(--disabled-opacity);}
.proxy-header {display:flex; margin-bottom:8px;}
.proxy-header button {padding:8px 12px; font-size:14px;}
.verifying {cursor:wait !important; background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent); background-size:40px 40px; animation:progress-bar-stripes 1s linear infinite;}
@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}
.progress-container {width:100%; background-color:var(--status-bg); border-radius:5px; margin:20px 0; position:relative; height:25px; overflow:hidden;}
.progress-bar {width:0; height:100%; background-color:var(--success-color); border-radius:5px; transition:width .4s ease;}
#progress-text {position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#fff; font-weight:700; text-shadow:1px 1px 2px rgba(0,0,0,.5);}
.status-header {display:flex; justify-content:space-between; align-items:center; margin-top:25px;}
.status-header>div {display:flex; gap:10px;}
.status-header h3 {margin:0; color:var(--label-color);}
.status-container {margin-top:10px; padding:10px; background-color:var(--status-bg); border:1px solid var(--fieldset-border); border-radius:5px; min-height:100px; max-height:200px; overflow-y:auto; text-align:left;}
.status-message {padding:5px 8px; border-bottom:1px solid var(--border-color); font-size:14px; word-break:break-all;}
.success {color:var(--success-color);} .error {color:var(--danger-color);} .warning {color:var(--warning-color);} .info {color:var(--info-color); font-weight:700;}
#results-dashboard {margin-top:25px;}
#results-table {width:100%; margin-top:10px; border-collapse:collapse; background-color:var(--status-bg);}
#results-table th, #results-table td {border:1px solid var(--fieldset-border); padding:10px; text-align:left;}
#results-table th {background-color:var(--bg-color); font-weight:600;}
#results-table tbody tr:nth-child(even) {background-color:var(--bg-color);}
#results-table td:first-child {max-width:200px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}
.explanation-text {font-size:13px; color:var(--label-color); margin-top:10px; padding:10px; background-color:var(--status-bg); border-radius:4px; border-left:3px solid var(--primary-color); line-height:1.6;}
.explanation-text strong {color:var(--text-color);}
.explanation-text a {color:var(--primary-color); text-decoration:none; font-weight:600;}
.explanation-text a:hover {text-decoration:underline;}
.explanation-text code {background-color:var(--bg-color); padding:2px 5px; border-radius:3px; font-family:monospace; font-weight:600;}
.preset-controls {display:flex; align-items:center; gap:10px; flex-wrap:wrap;}
.preset-controls>* {flex-grow:1;}
.theme-switcher {display:flex; align-items:center; gap:10px;}
.switch {position:relative; display:inline-block; width:44px; height:24px;}
.switch input {opacity:0; width:0; height:0;}
.slider {position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#ccc; transition:.4s;}
.slider:before {position:absolute; content:""; height:18px; width:18px; left:3px; bottom:3px; background-color:#fff; transition:.4s;}
input:checked+.slider {background-color:var(--primary-color);}
input:focus+.slider {box-shadow:0 0 1px var(--primary-color);}
input:checked+.slider:before {transform:translateX(20px);}
.slider.round {border-radius:24px;}
.slider.round:before {border-radius:50%;}


/* style.css - Añade esto al final */

/* --- Modal del Historial --- */
#history-modal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 700px;
    max-height: 80vh;
    border: 1px solid var(--fieldset-border);
    border-radius: 12px;
    padding: 0;
    background: var(--container-bg);
    color: var(--text-color);
    box-shadow: 0 5px 30px rgba(0,0,0,0.4);
}

/* Fondo semi-transparente cuando el modal está abierto */
#history-modal::backdrop {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(3px);
}

.modal-header, .modal-footer { padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; }
.modal-header { border-bottom: 1px solid var(--fieldset-border); }
.modal-footer { border-top: 1px solid var(--fieldset-border); }
.modal-header h2 { margin: 0; color: var(--header-color); }
#close-history { font-size: 24px; padding: 0 12px; line-height: 1; }

#history-list-container {
    padding: 20px;
    overflow-y: auto;
    max-height: calc(80vh - 140px); /* Ajusta altura para evitar desbordamiento */
}

.history-item {
    background: var(--bg-color);
    border: 1px solid var(--fieldset-border);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
}
.history-item-info strong { display: block; font-size: 16px; margin-bottom: 5px; }
.history-item-info span { font-size: 13px; color: var(--label-color); }
.history-item-actions { display: flex; gap: 10px; flex-shrink: 0; }
.history-item-actions button { font-size: 14px; padding: 8px 12px; }

/* --- Mejoras de UI --- */
.export-options { display: flex; gap: 10px; }